<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FieldSnap | The Sierra Suites</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/logged_in.css">
    <link rel="stylesheet" href="assets/css/fieldsnap.css">
</head>

<body>
    <div class="dashboard-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <img src="https://raw.githubusercontent.com/luckyask/test/main/TSS%20logo%20white.jpg"
                        alt="The Sierra Suites Logo">
                    <span>The Sierra Suites</span>
                </div>
                <button class="sidebar-toggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <div class="user-profile">
                <div class="avatar">
                    <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
                        alt="User Avatar" id="userAvatar">
                </div>
                <div class="user-info">
                    <h4 id="userName">Loading...</h4>
                    <p id="userCompany">Loading...</p>
                </div>
                <button class="profile-menu">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>

            <nav class="sidebar-nav">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fas fa-project-diagram"></i>
                            <span>Projects</span>
                        </a>
                    </li>
                    <li>
                        <a href="taskflow.html">
                            <i class="fas fa-tasks"></i>
                            <span>TaskFlow</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="fieldsnap.html">
                            <i class="fas fa-camera"></i>
                            <span>FieldSnap</span>
                        </a>
                    </li>
                    <li>
                        <a href="quotehub.html">
                            <i class="fas fa-file-invoice-dollar"></i>
                            <span>QuoteHub</span>
                        </a>
                    </li>
                    <li>
                        <a href="reportcenter.html">
                            <i class="fas fa-chart-pie"></i>
                            <span>ReportCenter</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="sidebar-footer">
                <div class="upgrade-card">
                    <h4>Upgrade to Pro</h4>
                    <p>Unlock advanced photo organization and search</p>
                    <a href="pricing.html" class="btn btn-primary btn-small">Upgrade Now</a>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header class="topbar">
                <div class="topbar-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2>FieldSnap</h2>
                    <div class="project-selector">
                        <select id="project-filter">
                            <option value="all">All Projects</option>
                            <!-- Projects will be dynamically populated -->
                        </select>
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search photos..." id="photo-search">
                    </div>
                    <div class="topbar-actions">
                        <button class="btn btn-primary" id="upload-photos-btn">
                            <i class="fas fa-cloud-upload-alt"></i>
                            Upload Photos
                        </button>
                        <button class="notification-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </button>
                    </div>
                </div>
            </header>

            <div class="content-container">
                <!-- Upgrade prompt for Starter tier -->
                <div class="upgrade-prompt">
                    <strong>Upgrade to Pro</strong> for advanced features like voice-to-text descriptions, GPS location
                    capture, and professional photo tagging.
                </div>

                <!-- Storage Usage -->
                <div class="storage-usage">
                    <h4>Storage Usage</h4>
                    <div class="storage-progress">
                        <div class="storage-progress-bar" id="storage-bar" style="width: 35%"></div>
                    </div>
                    <div class="storage-details">
                        <span id="storage-used">3.5 GB</span> of <span id="storage-total">10 GB</span> used
                    </div>
                </div>

                <!-- Map View -->
                <div class="map-view" id="map-view"></div>

                <!-- Filter Panel -->
                <div class="filter-panel" id="filter-panel">
                    <div class="filter-header">
                        <h3>Filter Photos</h3>
                        <button class="btn btn-icon" id="close-filter-panel">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="filter-grid">
                        <div class="form-group">
                            <label for="date-filter">Date Range</label>
                            <select id="date-filter">
                                <option value="all">All Dates</option>
                                <option value="today">Today</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="user-filter">Uploaded By</label>
                            <select id="user-filter">
                                <option value="all">All Users</option>
                                <!-- Users will be dynamically populated -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tag-filter">Tags</label>
                            <select id="tag-filter">
                                <option value="all">All Tags</option>
                                <option value="issue">Has Issues</option>
                                <option value="progress">Progress</option>
                                <option value="safety">Safety</option>
                                <option value="quality">Quality</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="status-filter">Status</label>
                            <select id="status-filter">
                                <option value="all">All Status</option>
                                <option value="approved">Approved</option>
                                <option value="pending">Pending Review</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-primary" id="apply-filters">Apply Filters</button>
                        <button class="btn btn-outline" id="reset-filters">Reset</button>
                    </div>
                </div>

                <div class="toolbar">
                    <div class="view-options">
                        <button class="btn btn-icon active" id="grid-view-btn">
                            <i class="fas fa-th-large"></i>
                        </button>
                        <button class="btn btn-icon" id="list-view-btn">
                            <i class="fas fa-list"></i>
                        </button>
                        <button class="btn btn-icon" id="map-view-btn">
                            <i class="fas fa-map"></i>
                        </button>
                    </div>
                    <div class="sort-options">
                        <select id="sort-select">
                            <option value="newest">Newest first</option>
                            <option value="oldest">Oldest first</option>
                            <option value="project">By project</option>
                        </select>
                    </div>
                    <div class="filter-options">
                        <button class="btn btn-outline" id="filter-btn">
                            <i class="fas fa-filter"></i>
                            Filters
                        </button>
                        <button class="btn btn-outline" id="bulk-actions-btn">
                            <i class="fas fa-cog"></i>
                            Bulk Actions
                        </button>
                    </div>
                </div>

                <div class="photos-grid" id="photos-container">
                    <div class="spinner" id="loading-spinner"></div>
                    <!-- Photos will be dynamically loaded here -->
                </div>

                <div class="pagination" id="pagination">
                    <button class="btn btn-outline" id="prev-page-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                        Previous
                    </button>
                    <div class="page-numbers" id="page-numbers">
                        <span class="active">1</span>
                    </div>
                    <button class="btn btn-outline" id="next-page-btn">
                        Next
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Photo Upload Modal -->
    <div class="modal" id="upload-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Photos</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="upload-area" id="drop-area">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h4>Drag & Drop Photos Here</h4>
                    <p>or</p>
                    <button class="btn btn-outline" id="browse-btn">Select Files</button>
                    <input type="file" id="file-input" multiple accept="image/*" style="display: none;">
                </div>

                <div class="upload-options">
                    <div class="form-group">
                        <label for="upload-project">Project</label>
                        <select id="upload-project">
                            <option value="">Select Project</option>
                            <!-- Projects will be dynamically populated -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="photo-description">Description (optional)</label>
                        <textarea id="photo-description" placeholder="Add a description for these photos"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="photo-tags">Tags (comma separated)</label>
                        <input type="text" id="photo-tags" placeholder="e.g., progress, issue, safety">
                    </div>

                    <div class="form-group">
                        <label class="checkbox-container">
                            <input type="checkbox" id="capture-location" checked>
                            <span class="checkmark"></span>
                            Capture location data
                        </label>
                    </div>

                    <!-- Voice-to-text button (Pro/Enterprise only) -->
                    <div class="form-group" id="voice-input-container" style="display: none;">
                        <button class="btn btn-outline" id="voice-btn">
                            <i class="fas fa-microphone"></i>
                            Voice Description
                        </button>
                    </div>
                </div>

                <div class="upload-preview" id="upload-preview">
                    <!-- Files will be previewed here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-upload">Cancel</button>
                <button class="btn btn-primary" id="start-upload-btn" disabled>Upload Photos</button>
            </div>
        </div>
    </div>

    <!-- Annotation Modal -->
    <div class="modal annotation-modal" id="annotation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Annotate Photo</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="annotation-tools">
                    <button class="btn btn-outline active" data-tool="select">
                        <i class="fas fa-mouse-pointer"></i> Select
                    </button>
                    <button class="btn btn-outline" data-tool="rectangle">
                        <i class="fas fa-square"></i> Rectangle
                    </button>
                    <button class="btn btn-outline" data-tool="circle">
                        <i class="fas fa-circle"></i> Circle
                    </button>
                    <button class="btn btn-outline" data-tool="arrow">
                        <i class="fas fa-arrow-right"></i> Arrow
                    </button>
                    <button class="btn btn-outline" data-tool="text">
                        <i class="fas fa-font"></i> Text
                    </button>
                    <button class="btn btn-outline" id="clear-annotations">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
                <div class="annotation-canvas-container">
                    <canvas id="annotation-canvas" width="800" height="500"></canvas>
                </div>
                <div class="form-group">
                    <label for="issue-description">Issue Description</label>
                    <textarea id="issue-description" placeholder="Describe the issue or annotation"></textarea>
                </div>
                <div class="form-group">
                    <label for="issue-assignee">Assign To</label>
                    <select id="issue-assignee">
                        <option value="">Select Team Member</option>
                        <!-- Team members will be dynamically populated -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="issue-priority">Priority</label>
                    <select id="issue-priority">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-annotation">Cancel</button>
                <button class="btn btn-primary" id="save-annotation">Save Annotation</button>
            </div>
        </div>
    </div>

    <!-- Load Cloudinary widget SDK -->
    <script src="https://upload-widget.cloudinary.com/global/all.js"></script>
    <!-- Load Supabase client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <!-- Load Leaflet for maps -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script src="assets/js/main.js"></script>
    <script src="assets/js/init_supabase.js"></script>
    <script src="assets/js/fieldsnap.js"></script>
</body>

</html>